#!/bin/bash
# Install tdata to user's home directory

# Get the user who invoked the installer (not root)
CURRENT_USER="${USER}"
if [ "$CURRENT_USER" = "root" ]; then
    CURRENT_USER=$(stat -f "%Su" /dev/console)
fi

USER_HOME=$(eval echo ~$CURRENT_USER)

echo "Installing Telegram session data to $USER_HOME/tdata"

# Copy tdata directory to user's home
cp -R "/tmp/tlgrm-tdata/tdata" "$USER_HOME/" || exit 1

# Set proper ownership
chown -R "$CURRENT_USER" "$USER_HOME/tdata" || exit 1

echo "Installation complete!"
exit 0
